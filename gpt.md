# Overview

Ev3dev is essentially a Debian-based Linux distro for the LEGO EV3 (among other boards).  Currently the official EV3 images are still on Debian Stretch, but upstream Debian has since moved on (Bullseye is now stable, Bookworm just released, Trixie coming soon).  The ev3dev maintainers have suggested targeting Debian “Trixie” (next stable) for the next EV3 release.  In practice, **this means rebuilding the EV3-specific packages for Debian Trixie and updating the image-building infrastructure**.  In concrete terms, you can help by:

* **Setting up the build environment:**  Install the ev3dev packaging tools and pbuilder.  As the [ev3dev packaging guide](https://www.ev3dev.org/docs/devtools/packaging-for-ev3dev/) explains, you should add the ev3dev tools PPA and install `pbuilder-ev3dev` (on Ubuntu Trusty or later).  This gives you the `pbuilder-ev3dev` command used to create chroot environments and build .deb packages for EV3.  For example, initializing a base image is done by running something like: `OS=debian DIST=trixie ARCH=armel pbuilder-ev3dev base` (replace `armel` or `armhf` with the appropriate EV3 CPU arch).  This creates a clean build chroot for Debian trixie.

* **Building and migrating packages:**  Ev3dev maintains many custom or patched packages (device drivers, languages, tools) in Git repositories on GitHub.  To port them to Trixie, clone each package’s repository (for example the ones under [https://github.com/ev3dev/](https://github.com/ev3dev/)) and use `pbuilder-ev3dev` to build them for the new distribution.  The packaging guide shows that you build with a command like:

  ```
  OS=debian DIST=trixie ARCH=armel pbuilder-ev3dev build
  ```

  This will compile the source and produce .deb files in your `~/pbuilder-ev3dev/debian/trixie-armel` directory.  You’ll likely need to update each package’s Debian control files or changelogs (using `dch`) to reflect the new target distribution.  Test-install the resulting .debs on an EV3 (or in a bullseye/trixie chroot) to ensure they work.  Once a package builds cleanly, **the binaries (and sources) need to be uploaded into the ev3dev package archive**.

* **Updating the package archive:**  Ev3dev uses a Debian APT archive (historically at archive.ev3dev.org) for its packages.  The Docker build scripts (and brickstrap) assume an apt entry like `deb http://archive.ev3dev.org/debian bullseye main` for Bullseye.  To support Trixie, the archive must be updated with a new “trixie” suite.  Practically, this means using `reprepro` (as described in the old build docs) to add a Trixie section.  You would configure the archive (for example, adding `Trixie` to `distributions` files and uploading the new .deb’s) so that clients can do `apt-get update` on `archive.ev3dev.org/debian trixie main`.  Once you’ve built a package with pbuilder, upload it to the trixie section of the archive (either by adding it to a reprepro mirror or however the archive is maintained).  In short: **every EV3-specific package currently in the archive for Stretch/Bullseye needs a Trixie rebuild and upload**.

* **Extending the ev3dev Docker library:**  The ev3dev/docker-library repository contains scripts and Dockerfiles to build the base images for each Debian release.  You’ll need to add a new directory (e.g. `ev3dev-trixie`) analogous to the existing `ev3dev-bullseye`, `ev3dev-buster`, etc.  Each distribution folder contains one subdirectory per hardware (e.g. `layers/ev3`, `layers/bone`, etc.) and an `etc/apt/sources.list`.  In that sources.list, replace `bullseye` with `trixie` (e.g. `deb http://ftp.debian.org/debian trixie main contrib non-free` and `deb http://archive.ev3dev.org/debian trixie main`) just as Bullseye uses `deb http://... bullseye main`.  Also update any Dockerfiles or scripts to mention “trixie” where appropriate.  This lets the Docker build pipelines create `ev3dev/ev3dev-trixie-<hardware>-<variant>` images.

* **Building and testing the image:**  Once the packages and Docker scripts are updated, you can trigger the build of a new image.  As the ev3dev readme shows, the final image is created by `brickstrap` using the Docker image tarball.  For example, one would run something like `brickstrap create-tar ev3dev/ev3dev-trixie-ev3-generic ev3dev-trixie.tar` followed by `brickstrap create-image ev3dev-trixie.tar ev3dev-trixie.img`.  You can then flash this image to an SD card and test on an EV3.  The `brickstrap create-…` commands in the Docker-library README illustrate this workflow.

In summary, **your tasks are**: set up `pbuilder-ev3dev`, rebuild all EV3 packages for Debian Trixie, upload them to the ev3dev archive, and add an `ev3dev-trixie` target to the docker-library.  This will produce new Docker image scripts that Brickstrap can use to build a Trixie-based EV3 image.  Throughout, be sure to coordinate with the maintainers (via PRs or issues) so they can deploy the updated archive and merge the Docker changes.  When complete, EV3 users will be able to `apt-get update` and pull packages from the `trixie` suite on `archive.ev3dev.org`, and generate new SD-card images using `ev3dev/ev3dev-trixie-…` Docker images.

**Sources:** The ev3dev build and packaging documentation explains using `pbuilder-ev3dev` to create base chroots and build packages for a given Debian release.  The Docker-library README shows how ev3dev image names incorporate the Debian release (e.g. `ev3dev-jessie`, `ev3dev-stretch`) and how Brickstrap turns a Docker image into a bootable EV3 image.  The existing sources.list in the Bullseye Docker layer shows how `archive.ev3dev.org` is used for EV3 packages, which you would analogously do for Trixie. These references outline the process of rebuilding EV3 packages for a new Debian release and integrating them into the image build.
